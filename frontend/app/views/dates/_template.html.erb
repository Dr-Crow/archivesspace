<% define_template "date_type_single", jsonmodel_definition(:date) do |form| %>
  <div class="inline-subform date-type-subform" data-date-type="single">
    <%= form.label_and_date "begin" %>
  </div>
<% end %>

<% define_template "date_type_inclusive", jsonmodel_definition(:date) do |form| %>
  <div class="inline-subform date-type-subform" data-date-type="inclusive">
    <%= form.label_and_date "begin" %>
    <%= form.label_and_date "end" %>
  </div>
<% end %>

<% define_template "date_type_range", jsonmodel_definition(:date) do |form| %>
  <div class="inline-subform date-type-subform" data-date-type="range">
    <%= form.label_and_date "begin" %>
    <%= form.label_and_date "end" %>
  </div>
<% end %>

<% define_template "date_type_bulk", jsonmodel_definition(:date) do |form| %>
  <div class="inline-subform date-type-subform" data-date-type="bulk">
    <%= form.label_and_date "begin" %>
    <%= form.label_and_date "end" %>
  </div>
<% end %>

<% define_template "date_type_nil", jsonmodel_definition(:date) do %>
  <div class="inline-subform date-type-subform">
    <div class="form-group">
      <div class="control-label col-sm-2"></div>
      <div class="controls col-sm-6"><em><%= I18n.t("date.date_type_message") %></em></div>
    </div>
  </div>
<% end %>


<% define_template "existence_date", jsonmodel_definition(:date) do |form| %>
  <div class="subrecord-form-fields">
    <div class="date-container">
      <%= form.label_and_select "label", form.possible_options_for("label", false, :include => ["existence"]) %>
      <%= form.label_and_textarea "expression", {:field_opts => {:placeholder => "Describe the date or date range"}, :required => :conditionally} %>
			<%= form.label_and_select "date_type", form.possible_options_for("date_type", true, :exclude => ["bulk", "inclusive"]), :required => true %>
      <%form.emit_template("date_fields") %>
    </div>
  </div>
<% end %>

<% define_template "existence_date_sdl", jsonmodel_definition(:structured_date_label) do |form| %>
  <div class="subrecord-form-fields">
    <div class="structured-date-label-container">
      <%= form.label_and_select "date_label", form.possible_options_for("date_label", false, :include => ["existence"]) %>
      <% if form.readonly? %>
        <%= form.label_and_select "date_type_enum", form.possible_options_for("date_type_enum", false) %>
      <% else %>
        <%= form.label_and_readonly "date_type_enum", "Add or update either a single or ranged date subrecord to set" %>
      <% end %>
      <%= form.label_and_select("date_certainty", form.possible_options_for("date_certainty", true)) %>
      <%= form.label_and_select("date_era", form.possible_options_for("date_era", true)) %>
      <%= form.label_and_select("date_calendar", form.possible_options_for("date_calendar", true)) %>

      <%= render_aspace_partial :partial => "shared/subrecord_form", :locals => {:form => form, :name => "structured_date_single", :section_id => "#{@agent.agent_type}_dates_of_existence_sds", :template_erb => "dates/template", :template => "structured_date_single_fields", :cardinality => :zero_to_one, :heading_text => I18n.t("agent._frontend.section.structured_date_single_fields")} %>

      <%= render_aspace_partial :partial => "shared/subrecord_form", :locals => {:form => form, :name => "structured_date_range", :section_id => "#{@agent.agent_type}_dates_of_existence_sdr", :template_erb => "dates/template", :template => "structured_date_range_fields", :cardinality => :zero_to_one, :heading_text => I18n.t("agent._frontend.section.structured_date_range_fields")} %>
    </div>
  </div>
<% end %>

<% define_template "structured_date_single_fields", jsonmodel_definition(:structured_date_single) do |form| %>
  <div class="subrecord-form-fields">
    <div class="structured-date-container">
      <%= form.label_and_select "date_role_enum", form.possible_options_for("date_role_enum", false, required: true) %>
      <%= form.label_and_textfield "date_expression",  {:field_opts => {:size => 30, :class => "form-control"} }%>
      <%= form.label_and_date "date_standardized" %>
      <%= form.label_and_select "date_standardized_type_enum", form.possible_options_for("date_standardized_type_enum", false) %>

    </div>
  </div>
<% end %>

<% define_template "structured_date_range_fields", jsonmodel_definition(:structured_date_single) do |form| %>
  <div class="subrecord-form-fields">
    <div class="structured-date-container">
      <%= form.label_and_textfield "begin_date_expression",  {:field_opts => {:size => 30, :class => "form-control"} }%>
      <%= form.label_and_date "begin_date_standardized" %>
      <%= form.label_and_select "begin_date_standardized_type_enum", form.possible_options_for("date_standardized_type_enum", false) %>

      <%= form.label_and_textfield "end_date_expression",  {:field_opts => {:size => 30, :class => "form-control"} }%>
      <%= form.label_and_date "end_date_standardized" %>
      <%= form.label_and_select "end_date_standardized_type_enum", form.possible_options_for("date_standardized_type_enum", false) %>

    </div>
  </div>
<% end %>

<% define_template "usage_date", jsonmodel_definition(:date) do |form| %>
  <div class="subrecord-form-fields">
    <div class="date-container">
      <%= form.label_and_select "label", form.possible_options_for("label", false, :include => ["usage"]) %>
      <%= form.label_and_textarea "expression", {:field_opts => {:placeholder => "Describe the date or date range"}, :required => :conditionally} %>
			<%= form.label_and_select "date_type", form.possible_options_for("date_type", true, :exclude => ["bulk", "inclusive"]), :required => true %>
      <%form.emit_template("date_fields") %>
    </div>
  </div>
<% end %>

<% define_template "usage_date_sdl", jsonmodel_definition(:structured_date_label) do |form| %>
  <div class="subrecord-form-fields">
    <div class="structured-date-label-container">
      <%= form.label_and_select "date_label", form.possible_options_for("date_label", false, :include => ["usage"]) %>
      <% if form.readonly? %>
        <%= form.label_and_select "date_type_enum", form.possible_options_for("date_type_enum", false) %>
      <% else %>
        <%= form.label_and_readonly "date_type_enum", "Add or update either a single or ranged date subrecord to set" %>
      <% end %>     
      <%= form.label_and_select("date_certainty", form.possible_options_for("date_certainty", true)) %>
      <%= form.label_and_select("date_era", form.possible_options_for("date_era", true)) %>
      <%= form.label_and_select("date_calendar", form.possible_options_for("date_calendar", true)) %>

      <%= render_aspace_partial :partial => "shared/subrecord_form", :locals => {:form => form, :name => "structured_date_single", :section_id => "#{@agent.agent_type}_usage_date_sds", :template_erb => "dates/template", :template => "structured_date_single_fields", :cardinality => :zero_to_one, :heading_text => I18n.t("agent._frontend.section.structured_date_single_fields")} %>

      <%= render_aspace_partial :partial => "shared/subrecord_form", :locals => {:form => form, :name => "structured_date_range", :section_id => "#{@agent.agent_type}_usage_date_sdr", :template_erb => "dates/template", :template => "structured_date_range_fields", :cardinality => :zero_to_one, :heading_text => I18n.t("agent._frontend.section.structured_date_range_fields")} %>
    </div>
  </div>
<% end %>

<% define_template "sdl_generic", jsonmodel_definition(:structured_date_label) do |form| %>
  <div class="subrecord-form-fields">
    <div class="structured-date-label-container">
      <%= form.label_and_select "date_label", form.possible_options_for("date_label", false) %>
      <% if form.readonly? %>
        <%= form.label_and_select "date_type_enum", form.possible_options_for("date_type_enum", false) %>
      <% else %>
        <%= form.label_and_readonly "date_type_enum", "Add or update either a single or ranged date subrecord to set" %>
      <% end %>
      <%= form.label_and_select("date_certainty", form.possible_options_for("date_certainty", true)) %>
      <%= form.label_and_select("date_era", form.possible_options_for("date_era", true)) %>
      <%= form.label_and_select("date_calendar", form.possible_options_for("date_calendar", true)) %>

      <%= render_aspace_partial :partial => "shared/subrecord_form", :locals => {:form => form, :name => "structured_date_single", :section_id => "#{@agent.agent_type}_sds", :template_erb => "dates/template", :template => "structured_date_single_fields", :cardinality => :zero_to_one, :heading_text => I18n.t("agent._frontend.section.structured_date_single_fields")} %>

      <%= render_aspace_partial :partial => "shared/subrecord_form", :locals => {:form => form, :name => "structured_date_range", :section_id => "#{@agent.agent_type}_sdr", :template_erb => "dates/template", :template => "structured_date_range_fields", :cardinality => :zero_to_one, :heading_text => I18n.t("agent._frontend.section.structured_date_range_fields")} %>
    </div>
  </div>
<% end %>

<% define_template "event_date", jsonmodel_definition(:date) do |form| %>
  <div class="subrecord-form-fields">
    <div class="date-container">
      <%= form.label_and_select "label", form.possible_options_for("label") %>
      <%= form.label_and_textarea "expression", {:field_opts => {:placeholder => "Describe the date or date range"}, :required => :conditionally} %>
			<%= form.label_and_select "date_type", form.possible_options_for("date_type", true, :exclude => ["bulk", "inclusive"]), :required => true %>
      <%form.emit_template("date_fields") %>
    </div>
  </div>
<% end %>


<% define_template "archival_record_date", jsonmodel_definition(:date) do |form| %>
  <div class="subrecord-form-fields">
    <div class="date-container">
      <%= form.label_and_select "label", form.possible_options_for("label"), :field_opts => {:default => "creation"} %>
			<%= form.label_and_textarea "expression", {:field_opts => {:placeholder => "Describe the date or date range"}, :required => :conditionally} %>
			<%= form.label_and_select "date_type", form.possible_options_for("date_type", true,:exclude => ["range"] ), :required => true %>
      <%form.emit_template("date_fields") %>
    </div>
  </div>
<% end %>


<% define_template "date", jsonmodel_definition(:date) do |form| %>
  <div class="subrecord-form-fields">
    <div class="date-container">
      <%= form.label_and_select "label", form.possible_options_for("label") %>
      <%= form.label_and_textarea "expression", {:field_opts => {:placeholder => "Describe the date or date range"}, :required => :conditionally} %>
			<%= form.label_and_select "date_type", form.possible_options_for("date_type", true, :exclude => (exclude ||= [])), :required => true %>
      <%form.emit_template("date_fields") %>
    </div>
  </div>
<% end %>


<% define_template "date_fields", jsonmodel_definition(:date) do |form| %>

  <% if !form.obj["date_type"].blank? %>
    <% form.emit_template("date_type_#{form.obj["date_type"]}", form.obj) %>
  <% elsif form.default_for("date_type") %>
    <% form.emit_template("date_type_#{form.default_for("date_type")}") %>
  <% else %>
    <% form.emit_template("date_type_nil") %>
  <% end %>

  <%= form.label_and_select("certainty", form.possible_options_for("certainty", true)) %>
  <%= form.label_and_select("era", form.possible_options_for("era", true)) %>
  <%= form.label_and_select("calendar", form.possible_options_for("calendar", true)) %>
<% end %>
